
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Apache Airflow DAG examples">
      
      
      
      
        <link rel="prev" href="../reference/">
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>REST API & CLI - Airflow Examples</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rest-api-cli" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Airflow Examples" class="md-header__button md-logo" aria-label="Airflow Examples" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Airflow Examples
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              REST API & CLI
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mortenoh/airflow-examples" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mortenoh/airflow-examples
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Airflow Examples" class="md-nav__button md-logo" aria-label="Airflow Examples" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Airflow Examples
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mortenoh/airflow-examples" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mortenoh/airflow-examples
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dag-basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DAG Basics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Operators
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Operators
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Provider Operators
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Patterns
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Patterns
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dag-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DAG Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Engineering
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Engineering
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-pipelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quality-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quality & Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../external-apis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    REST API & CLI
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    REST API & CLI
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connecting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Connecting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connecting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-url" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base URL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-jwt-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication: JWT Tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unauthenticated-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unauthenticated Endpoints
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-af-cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        The af CLI
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The af CLI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Global Options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-groups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Groups
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version-health" class="md-nav__link">
    <span class="md-ellipsis">
      
        Version &amp; Health
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Version &amp; Health">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-apiv2version" class="md-nav__link">
    <span class="md-ellipsis">
      
        GET /api/v2/version
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-apiv2monitorhealth" class="md-nav__link">
    <span class="md-ellipsis">
      
        GET /api/v2/monitor/health
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dags" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAGs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAGs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-dags" class="md-nav__link">
    <span class="md-ellipsis">
      
        List DAGs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dag-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAG Details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pause-unpause" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pause / Unpause
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-a-dag-run" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger a DAG Run
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trigger a DAG Run">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger Options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wait-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wait Mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-unpause" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auto-Unpause
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-dag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delete a DAG
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag-runs" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAG Runs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG Runs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-runs" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Runs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Run Details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task Instances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task Logs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waiting-for-a-run-to-finish" class="md-nav__link">
    <span class="md-ellipsis">
      
        Waiting for a Run to Finish
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variables
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get a Variable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a Variable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update a Variable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delete a Variable
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pools
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-pools" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Pools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get a Pool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a Pool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update a Pool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delete a Pool
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Connections
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Connections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-a-connection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get a Connection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcoms" class="md-nav__link">
    <span class="md-ellipsis">
      
        XComs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XComs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-xcom-entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        List XCom Entries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-an-xcom-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get an XCom Value
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#airflow-3-api-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Airflow 3 API Changes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recipes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recipes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-wait-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger + Wait + Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cicd-trigger-from-github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD: Trigger from GitHub Actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-unpause-all-dags" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bulk Unpause All DAGs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connecting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Connecting
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connecting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#base-url" class="md-nav__link">
    <span class="md-ellipsis">
      
        Base URL
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#authentication-jwt-tokens" class="md-nav__link">
    <span class="md-ellipsis">
      
        Authentication: JWT Tokens
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unauthenticated-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unauthenticated Endpoints
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-af-cli" class="md-nav__link">
    <span class="md-ellipsis">
      
        The af CLI
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The af CLI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Global Options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-groups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Groups
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#version-health" class="md-nav__link">
    <span class="md-ellipsis">
      
        Version &amp; Health
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Version &amp; Health">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-apiv2version" class="md-nav__link">
    <span class="md-ellipsis">
      
        GET /api/v2/version
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-apiv2monitorhealth" class="md-nav__link">
    <span class="md-ellipsis">
      
        GET /api/v2/monitor/health
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dags" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAGs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAGs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-dags" class="md-nav__link">
    <span class="md-ellipsis">
      
        List DAGs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dag-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAG Details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pause-unpause" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pause / Unpause
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-a-dag-run" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger a DAG Run
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trigger a DAG Run">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger Options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wait-mode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Wait Mode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-unpause" class="md-nav__link">
    <span class="md-ellipsis">
      
        Auto-Unpause
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-dag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delete a DAG
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag-runs" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAG Runs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG Runs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-runs" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Runs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Run Details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-instances" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task Instances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-logs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Task Logs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#waiting-for-a-run-to-finish" class="md-nav__link">
    <span class="md-ellipsis">
      
        Waiting for a Run to Finish
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variables
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Variables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get a Variable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a Variable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update a Variable
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-variable" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delete a Variable
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pools
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-pools" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Pools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get a Pool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a Pool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Update a Pool
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-pool" class="md-nav__link">
    <span class="md-ellipsis">
      
        Delete a Pool
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        Connections
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-connections" class="md-nav__link">
    <span class="md-ellipsis">
      
        List Connections
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-a-connection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get a Connection
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xcoms" class="md-nav__link">
    <span class="md-ellipsis">
      
        XComs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="XComs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-xcom-entries" class="md-nav__link">
    <span class="md-ellipsis">
      
        List XCom Entries
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-an-xcom-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get an XCom Value
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#airflow-3-api-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Airflow 3 API Changes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recipes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Recipes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trigger-wait-check" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trigger + Wait + Check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cicd-trigger-from-github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      
        CI/CD: Trigger from GitHub Actions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-unpause-all-dags" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bulk Unpause All DAGs
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="rest-api-cli">REST API &amp; CLI<a class="headerlink" href="#rest-api-cli" title="Permanent link">&para;</a></h1>
<p>Airflow has a web UI, and it is great for browsing DAGs, checking logs, and manually
triggering runs. But at some point you will want to do these things from a script -- trigger
a DAG from a CI/CD pipeline, bulk-unpause all your DAGs after a deployment, or poll a run
until it finishes so your next step can proceed. That is what the REST API is for.</p>
<p>This page covers two things:</p>
<ol>
<li><strong>The Airflow 3 REST API</strong> -- raw HTTP endpoints you can hit with curl or any HTTP client</li>
<li><strong>The <code>af</code> CLI</strong> -- a Typer wrapper around that API, installed with this project, that saves
   you from typing auth headers over and over</li>
</ol>
<p>We will start with curl so you understand what is actually happening over the wire, then
show the <code>af</code> shorthand for each operation.</p>
<hr />
<h2 id="connecting">Connecting<a class="headerlink" href="#connecting" title="Permanent link">&para;</a></h2>
<h3 id="base-url">Base URL<a class="headerlink" href="#base-url" title="Permanent link">&para;</a></h3>
<p>With the Docker Compose setup from this project, the API lives at:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>http://localhost:8081/api/v2/
</code></pre></div>
<p>Port 8081 is the web server port set in the <code>docker-compose.yml</code>. The <code>/api/v2/</code> prefix is
new in Airflow 3 -- Airflow 2 used <code>/api/v1/</code>.</p>
<p>Airflow ships a Swagger UI at <a href="http://localhost:8081/api/v2/docs">http://localhost:8081/api/v2/docs</a>
where you can explore every endpoint interactively.</p>
<h3 id="authentication-jwt-tokens">Authentication: JWT Tokens<a class="headerlink" href="#authentication-jwt-tokens" title="Permanent link">&para;</a></h3>
<p>Airflow 3 uses JWT (JSON Web Token) authentication. You POST your credentials to <code>/auth/token</code>
and get back an access token. Then you pass that token in the <code>Authorization</code> header on every
subsequent request.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Step 1: Get a token</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nv">TOKEN</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/auth/token<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;access_token&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1"># Step 2: Use the token</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>The token response looks like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">{</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;access_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;eyJhbGciOiJIUzI1NiIs...&quot;</span><span class="p">,</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;token_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bearer&quot;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="p">}</span>
</code></pre></div>
<p>This is a change from Airflow 2, which used basic auth (username/password on every request)
or session cookies.</p>
<h3 id="unauthenticated-endpoints">Unauthenticated Endpoints<a class="headerlink" href="#unauthenticated-endpoints" title="Permanent link">&para;</a></h3>
<p>Two endpoints do not require a token:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Airflow version</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/version
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Component health (scheduler, triggerer, dag_processor)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/monitor/health
</code></pre></div>
<p>These are useful for health checks in Docker Compose, Kubernetes, or monitoring scripts.</p>
<hr />
<h2 id="the-af-cli">The <code>af</code> CLI<a class="headerlink" href="#the-af-cli" title="Permanent link">&para;</a></h2>
<p>The <code>af</code> command is a <a href="https://typer.tiangolo.com/">Typer</a> CLI that wraps every API call
shown on this page. It handles JWT authentication transparently -- you never have to
manually fetch tokens.</p>
<h3 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h3>
<p>It is already installed when you set up this project:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>uv<span class="w"> </span>sync
</code></pre></div>
<p>The entry point is defined in <code>pyproject.toml</code> under <code>[project.scripts]</code>, so <code>uv sync</code>
makes the <code>af</code> command available in your virtualenv.</p>
<h3 id="global-options">Global Options<a class="headerlink" href="#global-options" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>af<span class="w"> </span>--help
</code></pre></div>
<table>
<thead>
<tr>
<th>Option</th>
<th>Env Var</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--base-url</code></td>
<td><code>AIRFLOW_URL</code></td>
<td><code>http://localhost:8081</code></td>
<td>Airflow web server URL</td>
</tr>
<tr>
<td><code>--username</code></td>
<td><code>AIRFLOW_USER</code></td>
<td><code>admin</code></td>
<td>Username for token auth</td>
</tr>
<tr>
<td><code>--password</code></td>
<td><code>AIRFLOW_PASS</code></td>
<td><code>admin</code></td>
<td>Password for token auth</td>
</tr>
</tbody>
</table>
<h3 id="command-groups">Command Groups<a class="headerlink" href="#command-groups" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>af version              Show Airflow version
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>af health               Show component health
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>af dags list            List all DAGs
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>af dags info &lt;id&gt;       Show DAG details
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>af dags pause &lt;id&gt;      Pause a DAG
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>af dags unpause &lt;id&gt;    Unpause a DAG
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>af dags trigger &lt;id&gt;    Trigger a DAG run [--wait] [--verbose/-v] [--conf] [--timeout] [--interval]
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>af dags delete &lt;id&gt;     Delete a DAG
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>af runs list &lt;dag&gt;      List runs for a DAG
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>af runs get &lt;dag&gt; &lt;run&gt; Show run details
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>af runs tasks &lt;dag&gt; &lt;run&gt;  List task instances
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>af runs logs &lt;dag&gt; &lt;run&gt; &lt;task&gt;  Show task logs
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>af runs wait &lt;dag&gt; &lt;run&gt;   Poll until terminal state
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>af vars list            List all variables
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>af vars get &lt;key&gt;       Get variable value
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>af vars set &lt;key&gt; &lt;val&gt; Create or update variable
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>af vars delete &lt;key&gt;    Delete variable
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>af pools list           List all pools
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>af pools get &lt;name&gt;     Get pool details
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>af pools set &lt;name&gt; &lt;slots&gt;  Create or update pool
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>af pools delete &lt;name&gt;  Delete pool
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>af conns list           List all connections
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>af conns get &lt;id&gt;       Get connection details
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>af xcoms list &lt;dag&gt; &lt;task&gt; [run]  List XCom entries
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>af xcoms list &lt;dag&gt; &lt;task&gt; --latest  List XCom entries (latest run)
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>af xcoms get &lt;dag&gt; &lt;task&gt; [run]   Get XCom value (default key: return_value)
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>af xcoms get &lt;dag&gt; &lt;task&gt; --latest  Get XCom value (latest run)
</code></pre></div>
<hr />
<h2 id="version-health">Version &amp; Health<a class="headerlink" href="#version-health" title="Permanent link">&para;</a></h2>
<p>These are the simplest endpoints and do not require authentication.</p>
<h3 id="get-apiv2version">GET /api/v2/version<a class="headerlink" href="#get-apiv2version" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/version
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3.0.1&quot;</span><span class="p">,</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="nt">&quot;git_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>af<span class="w"> </span>version
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c1"># 3.0.1</span>
</code></pre></div>
<h3 id="get-apiv2monitorhealth">GET /api/v2/monitor/health<a class="headerlink" href="#get-apiv2monitorhealth" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/monitor/health<span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nt">&quot;metadatabase&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;healthy&quot;</span><span class="w"> </span><span class="p">},</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">  </span><span class="nt">&quot;scheduler&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;healthy&quot;</span><span class="p">,</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="nt">&quot;latest_scheduler_heartbeat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T10:30:00+00:00&quot;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">  </span><span class="nt">&quot;triggerer&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;healthy&quot;</span><span class="p">,</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span><span class="nt">&quot;latest_triggerer_heartbeat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T10:30:00+00:00&quot;</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">  </span><span class="nt">&quot;dag_processor&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;healthy&quot;</span><span class="p">,</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">    </span><span class="nt">&quot;latest_dag_processor_heartbeat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T10:30:00+00:00&quot;</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>af<span class="w"> </span>health
</code></pre></div>
<hr />
<h2 id="dags">DAGs<a class="headerlink" href="#dags" title="Permanent link">&para;</a></h2>
<h3 id="list-dags">List DAGs<a class="headerlink" href="#list-dags" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>The response includes a <code>dags</code> array and a <code>total_entries</code> count. You can filter with query
parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>limit</code></td>
<td><code>?limit=10</code></td>
<td>Max results (default 100)</td>
</tr>
<tr>
<td><code>offset</code></td>
<td><code>?offset=10</code></td>
<td>Pagination offset</td>
</tr>
<tr>
<td><code>paused</code></td>
<td><code>?paused=true</code></td>
<td>Only paused / unpaused DAGs</td>
</tr>
<tr>
<td><code>dag_id_pattern</code></td>
<td><code>?dag_id_pattern=001%</code></td>
<td>Filter by DAG ID pattern</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># Only unpaused DAGs, first 5</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;http://localhost:8081/api/v2/dags?paused=false&amp;limit=5&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>af<span class="w"> </span>dags<span class="w"> </span>list
</code></pre></div>
<h3 id="dag-details">DAG Details<a class="headerlink" href="#dag-details" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">{</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">  </span><span class="nt">&quot;dag_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;001_hello_world&quot;</span><span class="p">,</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hello World -- your first DAG.&quot;</span><span class="p">,</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">  </span><span class="nt">&quot;is_paused&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">  </span><span class="nt">&quot;owners&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;airflow&quot;</span><span class="p">],</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">  </span><span class="nt">&quot;timetable_summary&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">  </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;basics&quot;</span><span class="p">}],</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">  </span><span class="nt">&quot;...&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>af<span class="w"> </span>dags<span class="w"> </span>info<span class="w"> </span>001_hello_world
</code></pre></div>
<h3 id="pause-unpause">Pause / Unpause<a class="headerlink" href="#pause-unpause" title="Permanent link">&para;</a></h3>
<p><strong>PATCH /api/v2/dags/{dag_id}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Pause</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;is_paused&quot;: true}&#39;</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c1"># Unpause</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;is_paused&quot;: false}&#39;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>af<span class="w"> </span>dags<span class="w"> </span>pause<span class="w"> </span>001_hello_world
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>af<span class="w"> </span>dags<span class="w"> </span>unpause<span class="w"> </span>001_hello_world
</code></pre></div>
<h3 id="trigger-a-dag-run">Trigger a DAG Run<a class="headerlink" href="#trigger-a-dag-run" title="Permanent link">&para;</a></h3>
<p><strong>POST /api/v2/dags/{dag_id}/dagRuns</strong></p>
<p>This is the most common API operation. You must provide a <code>logical_date</code> -- Airflow 3
requires it and will return 422 if you omit it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="s1">    &quot;logical_date&quot;: &quot;2025-01-15T12:00:00Z&quot;</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="s1">  }&#39;</span>
</code></pre></div>
<p>To pass configuration to the DAG:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="s1">    &quot;logical_date&quot;: &quot;2025-01-15T12:00:00Z&quot;,</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="s1">    &quot;conf&quot;: {&quot;key&quot;: &quot;value&quot;}</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="s1">  }&#39;</span>
</code></pre></div>
<p>Response:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="nt">&quot;dag_run_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">  </span><span class="nt">&quot;dag_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;001_hello_world&quot;</span><span class="p">,</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">  </span><span class="nt">&quot;logical_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:00+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">  </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;queued&quot;</span><span class="p">,</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">  </span><span class="nt">&quot;conf&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">  </span><span class="nt">&quot;...&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI (it generates <code>logical_date</code> automatically):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>001_hello_world
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>001_hello_world<span class="w"> </span>--conf<span class="w"> </span><span class="s1">&#39;{&quot;key&quot;: &quot;value&quot;}&#39;</span>
</code></pre></div>
<h4 id="trigger-options">Trigger Options<a class="headerlink" href="#trigger-options" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--wait</code></td>
<td>off</td>
<td>Poll until terminal state, then print task logs</td>
</tr>
<tr>
<td><code>--verbose</code> / <code>-v</code></td>
<td>off</td>
<td>Show full task logs (requires <code>--wait</code>)</td>
</tr>
<tr>
<td><code>--conf</code></td>
<td>none</td>
<td>JSON config string passed to the DAG run</td>
</tr>
<tr>
<td><code>--timeout</code></td>
<td>300</td>
<td>Max seconds to wait (requires <code>--wait</code>)</td>
</tr>
<tr>
<td><code>--interval</code></td>
<td>5</td>
<td>Poll interval in seconds (requires <code>--wait</code>)</td>
</tr>
</tbody>
</table>
<h4 id="wait-mode">Wait Mode<a class="headerlink" href="#wait-mode" title="Permanent link">&para;</a></h4>
<p><code>--wait</code> triggers the run, polls until it reaches a terminal state (<code>success</code>, <code>failed</code>, or
<code>upstream_failed</code>), and then prints logs for every task instance:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>110_dhis2_connection_basics<span class="w"> </span>--wait
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>Triggered: 110_dhis2_connection_basics
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>  run_id: manual__2025-01-15T12:00:00+00:00
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>  state:  queued
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>  [  0s] state=running
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>  [  5s] state=running
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>  [ 10s] state=success
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>Terminal state: success
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>--- show_connection [success] ---
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>  12:00:03  Connection details (password redacted):
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>  12:00:03    conn_id: dhis2_default
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>  12:00:03    conn_type: http
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>  ...
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>--- fetch_org_unit_count [success] ---
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>  12:00:05  Organisation unit count: 1575
</code></pre></div>
<p>By default, logs show only task stdout output, warnings, and errors. Add <code>--verbose</code> / <code>-v</code>
to include all log entries (Airflow internals, task lifecycle events):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>110_dhis2_connection_basics<span class="w"> </span>--wait<span class="w"> </span>--verbose
</code></pre></div>
<h4 id="auto-unpause">Auto-Unpause<a class="headerlink" href="#auto-unpause" title="Permanent link">&para;</a></h4>
<p>If the DAG is paused when you trigger it, <code>af dags trigger</code> will automatically unpause it so
the run executes, then re-pause it after the run completes (or if <code>--wait</code> is not used, after
the trigger returns). This means you do not need to manually unpause DAGs before triggering:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Even if 110_dhis2_connection_basics is paused, this works:</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>110_dhis2_connection_basics<span class="w"> </span>--wait
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="c1"># Output includes:</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1">#   Unpaused: 110_dhis2_connection_basics</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="c1">#   Triggered: 110_dhis2_connection_basics</span>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="c1">#   ...</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c1">#   Re-paused: 110_dhis2_connection_basics</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">logical_date must be unique</p>
<p>Each DAG run needs a unique <code>logical_date</code>. If you try to trigger with a date that
already has a run, you will get a 409 Conflict. The <code>af</code> CLI avoids this by using
the current UTC timestamp.</p>
</div>
<h3 id="delete-a-dag">Delete a DAG<a class="headerlink" href="#delete-a-dag" title="Permanent link">&para;</a></h3>
<p><strong>DELETE /api/v2/dags/{dag_id}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>DELETE<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>af<span class="w"> </span>dags<span class="w"> </span>delete<span class="w"> </span>001_hello_world
</code></pre></div>
<p>This removes the DAG metadata from the database. The DAG file on disk is not affected --
if the scheduler finds it on the next parse cycle, it will recreate the DAG entry.</p>
<hr />
<h2 id="dag-runs">DAG Runs<a class="headerlink" href="#dag-runs" title="Permanent link">&para;</a></h2>
<h3 id="list-runs">List Runs<a class="headerlink" href="#list-runs" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}/dagRuns</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>Response:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="p">{</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">  </span><span class="nt">&quot;dag_runs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w">      </span><span class="nt">&quot;dag_run_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">      </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">      </span><span class="nt">&quot;logical_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:00+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">      </span><span class="nt">&quot;start_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:01+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">      </span><span class="nt">&quot;end_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:05+00:00&quot;</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">  </span><span class="nt">&quot;total_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>af<span class="w"> </span>runs<span class="w"> </span>list<span class="w"> </span>001_hello_world
</code></pre></div>
<h3 id="run-details">Run Details<a class="headerlink" href="#run-details" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}/dagRuns/{run_id}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns/manual__2025-01-15T12:00:00+00:00<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>af<span class="w"> </span>runs<span class="w"> </span>get<span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
</code></pre></div>
<h3 id="task-instances">Task Instances<a class="headerlink" href="#task-instances" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}/dagRuns/{run_id}/taskInstances</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns/manual__2025-01-15T12:00:00+00:00/taskInstances<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>Response:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="p">{</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">  </span><span class="nt">&quot;task_instances&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">      </span><span class="nt">&quot;task_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;say_hello&quot;</span><span class="p">,</span>
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">      </span><span class="nt">&quot;state&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">,</span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="w">      </span><span class="nt">&quot;try_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="w">      </span><span class="nt">&quot;start_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:01+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="w">      </span><span class="nt">&quot;end_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:02+00:00&quot;</span>
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="w">  </span><span class="nt">&quot;total_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>af<span class="w"> </span>runs<span class="w"> </span>tasks<span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
</code></pre></div>
<h3 id="task-logs">Task Logs<a class="headerlink" href="#task-logs" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}/dagRuns/{run_id}/taskInstances/{task_id}/logs/{try_number}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns/manual__2025-01-15T12:00:00+00:00/taskInstances/say_hello/logs/1<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span>
</code></pre></div>
<p>This returns plain text (the task log output), not JSON.</p>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>af<span class="w"> </span>runs<span class="w"> </span>logs<span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span><span class="w"> </span>say_hello
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>af<span class="w"> </span>runs<span class="w"> </span>logs<span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span><span class="w"> </span>say_hello<span class="w"> </span>--try<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<h3 id="waiting-for-a-run-to-finish">Waiting for a Run to Finish<a class="headerlink" href="#waiting-for-a-run-to-finish" title="Permanent link">&para;</a></h3>
<p>There is no built-in streaming endpoint in the current Airflow 3 API, so the standard
approach is to poll the run status until it reaches a terminal state (<code>success</code>, <code>failed</code>,
or <code>upstream_failed</code>).</p>
<p>The <code>af</code> CLI has a <code>wait</code> command that does this for you:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>af<span class="w"> </span>runs<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span><span class="w"> </span>--timeout<span class="w"> </span><span class="m">300</span><span class="w"> </span>--interval<span class="w"> </span><span class="m">5</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>  [  0s] state=running
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>  [  5s] state=running
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>  [ 10s] state=success
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>Terminal state: success
</code></pre></div>
<p>If you want to do this with curl in a script:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nv">TOKEN</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/auth/token<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;access_token&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="nv">RUN_ID</span><span class="o">=</span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">  </span><span class="nv">STATE</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/001_hello_world/dagRuns/<span class="nv">$RUN_ID</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">    </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">    </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;state&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;state=</span><span class="nv">$STATE</span><span class="s2">&quot;</span>
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="nv">$STATE</span><span class="w"> </span><span class="k">in</span>
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">    </span>success<span class="p">|</span>failed<span class="p">|</span>upstream_failed<span class="o">)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">  </span><span class="k">esac</span>
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">5</span>
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a><span class="k">done</span>
</code></pre></div>
<hr />
<h2 id="variables">Variables<a class="headerlink" href="#variables" title="Permanent link">&para;</a></h2>
<p>Variables are key-value pairs stored in the Airflow database. DAGs can read them at parse
time or runtime. The API lets you manage them without touching the UI.</p>
<h3 id="list-variables">List Variables<a class="headerlink" href="#list-variables" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/variables</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/variables<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="p">{</span>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">  </span><span class="nt">&quot;variables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dag_107_schedule&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;@daily&quot;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">  </span><span class="nt">&quot;total_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>af<span class="w"> </span>vars<span class="w"> </span>list
</code></pre></div>
<h3 id="get-a-variable">Get a Variable<a class="headerlink" href="#get-a-variable" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/variables/{key}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/variables/dag_107_schedule<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="p">{</span><span class="w"> </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dag_107_schedule&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;@daily&quot;</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>af<span class="w"> </span>vars<span class="w"> </span>get<span class="w"> </span>dag_107_schedule
</code></pre></div>
<h3 id="create-a-variable">Create a Variable<a class="headerlink" href="#create-a-variable" title="Permanent link">&para;</a></h3>
<p><strong>POST /api/v2/variables</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/api/v2/variables<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;key&quot;: &quot;my_api_key&quot;, &quot;value&quot;: &quot;abc123&quot;}&#39;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>af<span class="w"> </span>vars<span class="w"> </span><span class="nb">set</span><span class="w"> </span>my_api_key<span class="w"> </span>abc123
</code></pre></div>
<p>The <code>af vars set</code> command is smart -- it tries PATCH first (update), and if the variable
does not exist (404), it falls back to POST (create).</p>
<h3 id="update-a-variable">Update a Variable<a class="headerlink" href="#update-a-variable" title="Permanent link">&para;</a></h3>
<p><strong>PATCH /api/v2/variables/{key}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span>http://localhost:8081/api/v2/variables/dag_107_schedule<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;key&quot;: &quot;dag_107_schedule&quot;, &quot;value&quot;: &quot;@hourly&quot;}&#39;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>af<span class="w"> </span>vars<span class="w"> </span><span class="nb">set</span><span class="w"> </span>dag_107_schedule<span class="w"> </span>@hourly
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Quirk: key is required in the PATCH body</p>
<p>Even though the key is in the URL path, the Airflow 3 API also requires it in the
request body. If you omit it, you get a 422 validation error.</p>
</div>
<h3 id="delete-a-variable">Delete a Variable<a class="headerlink" href="#delete-a-variable" title="Permanent link">&para;</a></h3>
<p><strong>DELETE /api/v2/variables/{key}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>DELETE<span class="w"> </span>http://localhost:8081/api/v2/variables/dag_107_schedule<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>af<span class="w"> </span>vars<span class="w"> </span>delete<span class="w"> </span>dag_107_schedule
</code></pre></div>
<hr />
<h2 id="pools">Pools<a class="headerlink" href="#pools" title="Permanent link">&para;</a></h2>
<p>Pools limit how many tasks can run concurrently for a given resource. If you have an API
that only allows 3 concurrent requests, you create a pool with 3 slots and assign your
tasks to it.</p>
<h3 id="list-pools">List Pools<a class="headerlink" href="#list-pools" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/pools</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/pools<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="p">{</span>
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="w">  </span><span class="nt">&quot;pools&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_pool&quot;</span><span class="p">,</span>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a><span class="w">      </span><span class="nt">&quot;slots&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span>
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a><span class="w">      </span><span class="nt">&quot;running_slots&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a><span class="w">      </span><span class="nt">&quot;queued_slots&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="w">  </span><span class="nt">&quot;total_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>af<span class="w"> </span>pools<span class="w"> </span>list
</code></pre></div>
<h3 id="get-a-pool">Get a Pool<a class="headerlink" href="#get-a-pool" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/pools/{name}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/pools/default_pool<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>af<span class="w"> </span>pools<span class="w"> </span>get<span class="w"> </span>default_pool
</code></pre></div>
<h3 id="create-a-pool">Create a Pool<a class="headerlink" href="#create-a-pool" title="Permanent link">&para;</a></h3>
<p><strong>POST /api/v2/pools</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/api/v2/pools<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;api_pool&quot;, &quot;slots&quot;: 3}&#39;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>af<span class="w"> </span>pools<span class="w"> </span><span class="nb">set</span><span class="w"> </span>api_pool<span class="w"> </span><span class="m">3</span>
</code></pre></div>
<p>Like <code>af vars set</code>, the <code>af pools set</code> command tries PATCH first, then falls back to POST.</p>
<h3 id="update-a-pool">Update a Pool<a class="headerlink" href="#update-a-pool" title="Permanent link">&para;</a></h3>
<p><strong>PATCH /api/v2/pools/{name}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span>http://localhost:8081/api/v2/pools/api_pool<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;api_pool&quot;, &quot;slots&quot;: 5}&#39;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>af<span class="w"> </span>pools<span class="w"> </span><span class="nb">set</span><span class="w"> </span>api_pool<span class="w"> </span><span class="m">5</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Pool name is not modifiable</p>
<p>In Airflow 3 you cannot rename a pool via PATCH. The <code>name</code> field in the body must
match the name in the URL. If you need a different name, delete the old pool and
create a new one.</p>
</div>
<h3 id="delete-a-pool">Delete a Pool<a class="headerlink" href="#delete-a-pool" title="Permanent link">&para;</a></h3>
<p><strong>DELETE /api/v2/pools/{name}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>DELETE<span class="w"> </span>http://localhost:8081/api/v2/pools/api_pool<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>af<span class="w"> </span>pools<span class="w"> </span>delete<span class="w"> </span>api_pool
</code></pre></div>
<hr />
<h2 id="connections">Connections<a class="headerlink" href="#connections" title="Permanent link">&para;</a></h2>
<p>Connections store credentials and host information for external systems (databases, APIs,
cloud services). The API exposes read-only access -- you can list and inspect connections
but creating/modifying them is typically done via the UI or environment variables.</p>
<h3 id="list-connections">List Connections<a class="headerlink" href="#list-connections" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/connections</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/connections<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="p">{</span>
<a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="w">  </span><span class="nt">&quot;connections&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a><span class="w">      </span><span class="nt">&quot;connection_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postgres_default&quot;</span><span class="p">,</span>
<a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="w">      </span><span class="nt">&quot;conn_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
<a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="w">      </span><span class="nt">&quot;host&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;postgres&quot;</span><span class="p">,</span>
<a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a><span class="w">      </span><span class="nt">&quot;port&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5432</span>
<a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a><span class="w">  </span><span class="nt">&quot;total_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>af<span class="w"> </span>conns<span class="w"> </span>list
</code></pre></div>
<h3 id="get-a-connection">Get a Connection<a class="headerlink" href="#get-a-connection" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/connections/{connection_id}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/connections/postgres_default<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>af<span class="w"> </span>conns<span class="w"> </span>get<span class="w"> </span>postgres_default
</code></pre></div>
<hr />
<h2 id="xcoms">XComs<a class="headerlink" href="#xcoms" title="Permanent link">&para;</a></h2>
<p>XCom ("cross-communication") entries are how tasks pass data to each other. When a
PythonOperator returns a value, Airflow stores it as an XCom entry with the key
<code>return_value</code>. The API lets you inspect these values without opening the web UI.</p>
<h3 id="list-xcom-entries">List XCom Entries<a class="headerlink" href="#list-xcom-entries" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}/dagRuns/{run_id}/taskInstances/{task_id}/xcomEntries</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/002_python_operator/dagRuns/manual__2025-01-15T12:00:00+00:00/taskInstances/greet/xcomEntries<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<p>Response:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="p">{</span>
<a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="w">  </span><span class="nt">&quot;xcom_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="w">    </span><span class="p">{</span>
<a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="w">      </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;return_value&quot;</span><span class="p">,</span>
<a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="w">      </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hello, Airflow!&quot;</span><span class="p">,</span>
<a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="w">      </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:05+00:00&quot;</span>
<a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a><span class="w">  </span><span class="nt">&quot;total_entries&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="c1"># With an explicit run ID</span>
<a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>af<span class="w"> </span>xcoms<span class="w"> </span>list<span class="w"> </span>002_python_operator<span class="w"> </span>greet<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
<a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a>
<a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a><span class="c1"># Or use --latest to automatically pick the most recent run</span>
<a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>af<span class="w"> </span>xcoms<span class="w"> </span>list<span class="w"> </span>002_python_operator<span class="w"> </span>greet<span class="w"> </span>--latest
</code></pre></div>
<h3 id="get-an-xcom-value">Get an XCom Value<a class="headerlink" href="#get-an-xcom-value" title="Permanent link">&para;</a></h3>
<p><strong>GET /api/v2/dags/{dag_id}/dagRuns/{run_id}/taskInstances/{task_id}/xcomEntries/{key}</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags/002_python_operator/dagRuns/manual__2025-01-15T12:00:00+00:00/taskInstances/greet/xcomEntries/return_value<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>json.tool
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="p">{</span>
<a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a><span class="w">  </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;return_value&quot;</span><span class="p">,</span>
<a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="w">  </span><span class="nt">&quot;value&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Hello, Airflow!&quot;</span><span class="p">,</span>
<a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a><span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-15T12:00:05+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a><span class="w">  </span><span class="nt">&quot;dag_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;002_python_operator&quot;</span><span class="p">,</span>
<a id="__codelineno-76-6" name="__codelineno-76-6" href="#__codelineno-76-6"></a><span class="w">  </span><span class="nt">&quot;run_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span><span class="p">,</span>
<a id="__codelineno-76-7" name="__codelineno-76-7" href="#__codelineno-76-7"></a><span class="w">  </span><span class="nt">&quot;task_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;greet&quot;</span>
<a id="__codelineno-76-8" name="__codelineno-76-8" href="#__codelineno-76-8"></a><span class="p">}</span>
</code></pre></div>
<p>With the CLI:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="c1"># Default key is return_value</span>
<a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>af<span class="w"> </span>xcoms<span class="w"> </span>get<span class="w"> </span>002_python_operator<span class="w"> </span>greet<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
<a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>
<a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a><span class="c1"># Use --latest instead of a run ID</span>
<a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>af<span class="w"> </span>xcoms<span class="w"> </span>get<span class="w"> </span>002_python_operator<span class="w"> </span>greet<span class="w"> </span>--latest
<a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>
<a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a><span class="c1"># Explicit key</span>
<a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a>af<span class="w"> </span>xcoms<span class="w"> </span>get<span class="w"> </span>002_python_operator<span class="w"> </span>greet<span class="w"> </span>--latest<span class="w"> </span>--key<span class="w"> </span>return_value
<a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a>
<a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a><span class="c1"># Full JSON response</span>
<a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a>af<span class="w"> </span>xcoms<span class="w"> </span>get<span class="w"> </span>002_python_operator<span class="w"> </span>greet<span class="w"> </span>--latest<span class="w"> </span>--json
</code></pre></div>
<hr />
<h2 id="airflow-3-api-changes">Airflow 3 API Changes<a class="headerlink" href="#airflow-3-api-changes" title="Permanent link">&para;</a></h2>
<p>If you are coming from Airflow 2, here are the key differences:</p>
<table>
<thead>
<tr>
<th>What Changed</th>
<th>Airflow 2</th>
<th>Airflow 3</th>
</tr>
</thead>
<tbody>
<tr>
<td>Base path</td>
<td><code>/api/v1/</code></td>
<td><code>/api/v2/</code></td>
</tr>
<tr>
<td>Authentication</td>
<td>Basic auth or session cookies</td>
<td>JWT tokens via <code>/auth/token</code></td>
</tr>
<tr>
<td>Trigger field</td>
<td><code>execution_date</code></td>
<td><code>logical_date</code> (required)</td>
</tr>
<tr>
<td>Validation errors</td>
<td>400 Bad Request</td>
<td>422 Unprocessable Entity</td>
</tr>
<tr>
<td>Pool rename</td>
<td>Allowed via PATCH</td>
<td>Not allowed -- name is immutable</td>
</tr>
<tr>
<td>Variable PATCH body</td>
<td>Only <code>value</code> needed</td>
<td><code>key</code> required in body alongside <code>value</code></td>
</tr>
<tr>
<td>Swagger UI</td>
<td><code>/api/v1/ui/</code></td>
<td><code>/api/v2/docs</code></td>
</tr>
</tbody>
</table>
<p>The <code>execution_date</code> to <code>logical_date</code> rename is the most common thing that breaks
existing scripts. If you see 422 errors after upgrading, check that your trigger payloads
use <code>logical_date</code>.</p>
<hr />
<h2 id="recipes">Recipes<a class="headerlink" href="#recipes" title="Permanent link">&para;</a></h2>
<h3 id="trigger-wait-check">Trigger + Wait + Check<a class="headerlink" href="#trigger-wait-check" title="Permanent link">&para;</a></h3>
<p>The most common pattern: trigger a DAG, wait for it to finish, then check the result.</p>
<p>With <code>af</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>001_hello_world<span class="w"> </span>--wait
</code></pre></div>
<p>This single command triggers the run, polls until it completes, and prints task logs. It exits
with code 0 on success and code 1 on failure, making it suitable for CI/CD scripts. Add
<code>--verbose</code> to see full Airflow log output instead of just task stdout.</p>
<p><strong>Manual alternative</strong> -- if you need more control over each step, you can still do it in
three commands:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="c1"># Trigger and capture the run ID</span>
<a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>af<span class="w"> </span>dags<span class="w"> </span>trigger<span class="w"> </span>001_hello_world
<a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="c1"># Output:</span>
<a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a><span class="c1">#   Triggered: 001_hello_world</span>
<a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="c1">#   run_id: manual__2025-01-15T12:00:00+00:00</span>
<a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a><span class="c1">#   state:  queued</span>
<a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>
<a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a><span class="c1"># Wait for completion</span>
<a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>af<span class="w"> </span>runs<span class="w"> </span><span class="nb">wait</span><span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
<a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a>
<a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a><span class="c1"># Check task results</span>
<a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a>af<span class="w"> </span>runs<span class="w"> </span>tasks<span class="w"> </span>001_hello_world<span class="w"> </span><span class="s2">&quot;manual__2025-01-15T12:00:00+00:00&quot;</span>
</code></pre></div>
<p>With curl in a script:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="ch">#!/usr/bin/env bash</span>
<a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a><span class="nb">set</span><span class="w"> </span>-euo<span class="w"> </span>pipefail
<a id="__codelineno-80-3" name="__codelineno-80-3" href="#__codelineno-80-3"></a>
<a id="__codelineno-80-4" name="__codelineno-80-4" href="#__codelineno-80-4"></a><span class="nv">BASE</span><span class="o">=</span><span class="s2">&quot;http://localhost:8081&quot;</span>
<a id="__codelineno-80-5" name="__codelineno-80-5" href="#__codelineno-80-5"></a>
<a id="__codelineno-80-6" name="__codelineno-80-6" href="#__codelineno-80-6"></a><span class="c1"># Authenticate</span>
<a id="__codelineno-80-7" name="__codelineno-80-7" href="#__codelineno-80-7"></a><span class="nv">TOKEN</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BASE</span><span class="s2">/auth/token&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-8" name="__codelineno-80-8" href="#__codelineno-80-8"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-9" name="__codelineno-80-9" href="#__codelineno-80-9"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-10" name="__codelineno-80-10" href="#__codelineno-80-10"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;access_token&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-80-11" name="__codelineno-80-11" href="#__codelineno-80-11"></a>
<a id="__codelineno-80-12" name="__codelineno-80-12" href="#__codelineno-80-12"></a><span class="nv">AUTH</span><span class="o">=</span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span>
<a id="__codelineno-80-13" name="__codelineno-80-13" href="#__codelineno-80-13"></a>
<a id="__codelineno-80-14" name="__codelineno-80-14" href="#__codelineno-80-14"></a><span class="c1"># Trigger</span>
<a id="__codelineno-80-15" name="__codelineno-80-15" href="#__codelineno-80-15"></a><span class="nv">RESPONSE</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BASE</span><span class="s2">/api/v2/dags/001_hello_world/dagRuns&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-16" name="__codelineno-80-16" href="#__codelineno-80-16"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$AUTH</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-17" name="__codelineno-80-17" href="#__codelineno-80-17"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-18" name="__codelineno-80-18" href="#__codelineno-80-18"></a><span class="w">  </span>-d<span class="w"> </span><span class="s2">&quot;{\&quot;logical_date\&quot;: \&quot;</span><span class="k">$(</span>date<span class="w"> </span>-u<span class="w"> </span>+%Y-%m-%dT%H:%M:%SZ<span class="k">)</span><span class="s2">\&quot;}&quot;</span><span class="k">)</span>
<a id="__codelineno-80-19" name="__codelineno-80-19" href="#__codelineno-80-19"></a>
<a id="__codelineno-80-20" name="__codelineno-80-20" href="#__codelineno-80-20"></a><span class="nv">RUN_ID</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$RESPONSE</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;dag_run_id&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-80-21" name="__codelineno-80-21" href="#__codelineno-80-21"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Triggered run: </span><span class="nv">$RUN_ID</span><span class="s2">&quot;</span>
<a id="__codelineno-80-22" name="__codelineno-80-22" href="#__codelineno-80-22"></a>
<a id="__codelineno-80-23" name="__codelineno-80-23" href="#__codelineno-80-23"></a><span class="c1"># Poll</span>
<a id="__codelineno-80-24" name="__codelineno-80-24" href="#__codelineno-80-24"></a><span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-80-25" name="__codelineno-80-25" href="#__codelineno-80-25"></a><span class="w">  </span><span class="nv">STATE</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$BASE</span><span class="s2">/api/v2/dags/001_hello_world/dagRuns/</span><span class="nv">$RUN_ID</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-26" name="__codelineno-80-26" href="#__codelineno-80-26"></a><span class="w">    </span>-H<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$AUTH</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-80-27" name="__codelineno-80-27" href="#__codelineno-80-27"></a><span class="w">    </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;state&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-80-28" name="__codelineno-80-28" href="#__codelineno-80-28"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;state=</span><span class="nv">$STATE</span><span class="s2">&quot;</span>
<a id="__codelineno-80-29" name="__codelineno-80-29" href="#__codelineno-80-29"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="nv">$STATE</span><span class="w"> </span><span class="k">in</span>
<a id="__codelineno-80-30" name="__codelineno-80-30" href="#__codelineno-80-30"></a><span class="w">    </span>success<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Done.&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-80-31" name="__codelineno-80-31" href="#__codelineno-80-31"></a><span class="w">    </span>failed<span class="p">|</span>upstream_failed<span class="o">)</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Failed.&quot;</span><span class="p">;</span><span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">;;</span>
<a id="__codelineno-80-32" name="__codelineno-80-32" href="#__codelineno-80-32"></a><span class="w">  </span><span class="k">esac</span>
<a id="__codelineno-80-33" name="__codelineno-80-33" href="#__codelineno-80-33"></a><span class="w">  </span>sleep<span class="w"> </span><span class="m">5</span>
<a id="__codelineno-80-34" name="__codelineno-80-34" href="#__codelineno-80-34"></a><span class="k">done</span>
</code></pre></div>
<h3 id="cicd-trigger-from-github-actions">CI/CD: Trigger from GitHub Actions<a class="headerlink" href="#cicd-trigger-from-github-actions" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="c1"># .github/workflows/trigger-dag.yml</span>
<a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Trigger Airflow DAG</span>
<a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>
<a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a><span class="nt">on</span><span class="p">:</span>
<a id="__codelineno-81-5" name="__codelineno-81-5" href="#__codelineno-81-5"></a><span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<a id="__codelineno-81-6" name="__codelineno-81-6" href="#__codelineno-81-6"></a><span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<a id="__codelineno-81-7" name="__codelineno-81-7" href="#__codelineno-81-7"></a>
<a id="__codelineno-81-8" name="__codelineno-81-8" href="#__codelineno-81-8"></a><span class="nt">jobs</span><span class="p">:</span>
<a id="__codelineno-81-9" name="__codelineno-81-9" href="#__codelineno-81-9"></a><span class="w">  </span><span class="nt">trigger</span><span class="p">:</span>
<a id="__codelineno-81-10" name="__codelineno-81-10" href="#__codelineno-81-10"></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
<a id="__codelineno-81-11" name="__codelineno-81-11" href="#__codelineno-81-11"></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<a id="__codelineno-81-12" name="__codelineno-81-12" href="#__codelineno-81-12"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get Airflow token</span>
<a id="__codelineno-81-13" name="__codelineno-81-13" href="#__codelineno-81-13"></a><span class="w">        </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auth</span>
<a id="__codelineno-81-14" name="__codelineno-81-14" href="#__codelineno-81-14"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-81-15" name="__codelineno-81-15" href="#__codelineno-81-15"></a><span class="w">          </span><span class="no">TOKEN=$(curl -s -X POST ${{ secrets.AIRFLOW_URL }}/auth/token \</span>
<a id="__codelineno-81-16" name="__codelineno-81-16" href="#__codelineno-81-16"></a><span class="w">            </span><span class="no">-H &quot;Content-Type: application/json&quot; \</span>
<a id="__codelineno-81-17" name="__codelineno-81-17" href="#__codelineno-81-17"></a><span class="w">            </span><span class="no">-d &#39;{&quot;username&quot;: &quot;${{ secrets.AIRFLOW_USER }}&quot;, &quot;password&quot;: &quot;${{ secrets.AIRFLOW_PASS }}&quot;}&#39; \</span>
<a id="__codelineno-81-18" name="__codelineno-81-18" href="#__codelineno-81-18"></a><span class="w">            </span><span class="no">| python3 -c &quot;import sys,json; print(json.load(sys.stdin)[&#39;access_token&#39;])&quot;)</span>
<a id="__codelineno-81-19" name="__codelineno-81-19" href="#__codelineno-81-19"></a><span class="w">          </span><span class="no">echo &quot;token=$TOKEN&quot; &gt;&gt; &quot;$GITHUB_OUTPUT&quot;</span>
<a id="__codelineno-81-20" name="__codelineno-81-20" href="#__codelineno-81-20"></a>
<a id="__codelineno-81-21" name="__codelineno-81-21" href="#__codelineno-81-21"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Trigger DAG</span>
<a id="__codelineno-81-22" name="__codelineno-81-22" href="#__codelineno-81-22"></a><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-81-23" name="__codelineno-81-23" href="#__codelineno-81-23"></a><span class="w">          </span><span class="no">curl -s -X POST ${{ secrets.AIRFLOW_URL }}/api/v2/dags/my_deploy_dag/dagRuns \</span>
<a id="__codelineno-81-24" name="__codelineno-81-24" href="#__codelineno-81-24"></a><span class="w">            </span><span class="no">-H &quot;Authorization: Bearer ${{ steps.auth.outputs.token }}&quot; \</span>
<a id="__codelineno-81-25" name="__codelineno-81-25" href="#__codelineno-81-25"></a><span class="w">            </span><span class="no">-H &quot;Content-Type: application/json&quot; \</span>
<a id="__codelineno-81-26" name="__codelineno-81-26" href="#__codelineno-81-26"></a><span class="w">            </span><span class="no">-d &quot;{\&quot;logical_date\&quot;: \&quot;$(date -u +%Y-%m-%dT%H:%M:%SZ)\&quot;, \&quot;conf\&quot;: {\&quot;commit\&quot;: \&quot;${{ github.sha }}\&quot;}}&quot;</span>
</code></pre></div>
<h3 id="bulk-unpause-all-dags">Bulk Unpause All DAGs<a class="headerlink" href="#bulk-unpause-all-dags" title="Permanent link">&para;</a></h3>
<p>With <code>af</code> and a bit of shell:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>af<span class="w"> </span>dags<span class="w"> </span>list<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span>+3<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;{print $1}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>dag_id<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a><span class="w">  </span>af<span class="w"> </span>dags<span class="w"> </span>unpause<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$dag_id</span><span class="s2">&quot;</span>
<a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="k">done</span>
</code></pre></div>
<p>With curl:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="nv">TOKEN</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>http://localhost:8081/auth/token<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;admin&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import sys,json; print(json.load(sys.stdin)[&#39;access_token&#39;])&quot;</span><span class="k">)</span>
<a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>
<a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:8081/api/v2/dags?paused<span class="o">=</span>true<span class="p">&amp;</span><span class="nv">limit</span><span class="o">=</span><span class="m">500</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a><span class="w">  </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span>
<a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a><span class="s2">import sys, json</span>
<a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a><span class="s2">for dag in json.load(sys.stdin)[&#39;dags&#39;]:</span>
<a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a><span class="s2">    print(dag[&#39;dag_id&#39;])</span>
<a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>dag_id<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a><span class="w">  </span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span><span class="s2">&quot;http://localhost:8081/api/v2/dags/</span><span class="nv">$dag_id</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a><span class="w">    </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a><span class="w">    </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-83-16" name="__codelineno-83-16" href="#__codelineno-83-16"></a><span class="w">    </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;is_paused&quot;: false}&#39;</span>
<a id="__codelineno-83-17" name="__codelineno-83-17" href="#__codelineno-83-17"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Unpaused: </span><span class="nv">$dag_id</span><span class="s2">&quot;</span>
<a id="__codelineno-83-18" name="__codelineno-83-18" href="#__codelineno-83-18"></a><span class="k">done</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>